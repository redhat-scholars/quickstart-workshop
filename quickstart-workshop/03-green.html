<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Custom Console Hackathon</title>
    <link rel="canonical" href="https://redhat-scholars.github.io/quickstart-workshop/quickstart-workshop/03-green.html">
    <link rel="prev" href="03-menu.html">
    <link rel="next" href="03-red.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="../_/img/NewRHDFullLogo_4-color_white-wordmark.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://redhat-scholars.github.io/quickstart-workshop">Custom Console Hackathon</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="quickstart-workshop" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html"></a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#scoring">Scoring Guidelines</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="01-web-terminal.html">1. Web Terminal</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-web-terminal.html#install">1.1 Installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-web-terminal.html#basics">1.2 Basics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-quickstarts.html">2. ConsoleQuickStarts</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-quickstarts.html#quickstart_basics">2.1 Basics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-quickstarts.html#quickstart_advanced">2.2 Change the Defaults</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-quickstarts.html#quickstart_modifications">2.3 Modifications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-quickstarts.html#quickstart_test">2.4 Test</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="03-menu.html">3. Customization Menu</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-green.html">3. Green Customisations</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_pre_applied_customisations">Pre-Applied Customisations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_customise_the_web_terminal">Customise the Web Terminal</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_customising_the_openshift_web_console">Web Console Customisations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_using_gitops_to_manage_cluster_resources">Use GitOps to Manage Customisations</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-red.html">3. Red Customizations</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-red.html#notifications">3.1 Console Notifications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-red.html#header_logo">3.2 Header Logo</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-red.html#login_screen">3.3 Login Screen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-red.html#custom_web_terminal">3.4 Web Terminal Customizations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-red.html#quickstart_install">3.5 QuickStart installation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-blue.html">3. Blue Customizations</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-blue.html#notifications">3.1 Console Notifications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-blue.html#header_logo">3.2 Header Logo</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-blue.html#custom_web_terminal">3.3 Web Terminal Customizations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-blue.html#quickstart_install">3.4 QuickStart installation</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Console Customization Hackathon</a></li>
    <li><a href="03-green.html">3. Green Customisations</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-scholars/quickstart-workshop/edit/master/documentation/modules/ROOT/pages/03-green.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<div class="sect1">
<h2 id="_welcome_to_the_green_team_cluster"><a class="anchor" href="#_welcome_to_the_green_team_cluster"></a>Welcome to the Green Team Cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This cluster demonstrates how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Customise the tools incldued in the Web Terminal that you deployed in a prior section.</p>
</li>
<li>
<p>Use <a href="https://developers.redhat.com/topics/gitops" target="_blank" rel="noopener">GitOps</a> to automatically synchronise your customisations to the OpenShift cluster:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Console notification banners using the <a href="https://docs.openshift.com/container-platform/4.10/web_console/customizing-the-web-console.html#creating-custom-notification-banners_customizing-web-console" target="_blank" rel="noopener">ConsoleNotification CRD</a>.</p>
</li>
<li>
<p>YAML samples for <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/" target="_blank" rel="noopener">CustomResources</a> using the <a href="https://docs.openshift.com/container-platform/4.10/web_console/customizing-the-web-console.html#adding-yaml-examples-to-kube-resources_customizing-web-console" target="_blank" rel="noopener">ConsoleYAMLSample CRD</a>.</p>
</li>
<li>
<p>Custom links to using the <a href="https://docs.openshift.com/container-platform/4.10/web_console/customizing-the-web-console.html#creating-custom-links_customizing-web-console" target="_blank" rel="noopener">ConsoleLink CRD</a>.
.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Using a <a href="https://docs.openshift.com/container-platform/4.10/monitoring/managing-metrics.html#specifying-how-a-service-is-monitored_managing-metrics" target="_blank" rel="noopener">ServiceMonitor CR</a> to collect custom application metrics.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pre_applied_customisations"><a class="anchor" href="#_pre_applied_customisations"></a>Pre-Applied Customisations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Your Green Team cluster already has a fun customisation pre-applied. Try it out:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Login to your OpenShift Web Console using the credentials supplied by your workshop administrator.</p>
</li>
<li>
<p>Expand the <strong>Application Launcher</strong>* menu (the 3x3 sqaure icon) in the top-right of the OpenShift console.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Notice that there&#8217;s a <strong>Cluster Argo CD</strong> link in the launcher. This is an example of a customisation that has been pre-applied to your cluster.</p>
</div>
<div class="paragraph">
<p>To see another example of a customisation, logout of the cluster by clicking your username in the top-right corner and clicking the <strong>Log out</strong> link!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_customise_the_web_terminal"><a class="anchor" href="#_customise_the_web_terminal"></a>Customise the Web Terminal</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Customising the Web Terminal tooling image enables you to provide your developers with specific versions of tools to use directly from the OpenShift Web Console.</p>
</div>
<div class="paragraph">
<p>The source code for the default tooling container image is available in the <a href="https://github.com/redhat-developer/web-terminal-tooling" target="_blank" rel="noopener">redhat-developer/web-terminal-tooling</a> repository on GitHub.</p>
</div>
<div class="paragraph">
<p>In this guide you&#8217;ll customise the Web Terminal tooling container to use a pre-prepared container image.</p>
</div>
<div class="sect2">
<h3 id="_modify_the_web_terminal_container_image"><a class="anchor" href="#_modify_the_web_terminal_container_image"></a>Modify the Web Terminal Container Image</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Login to your OpenShift cluster as a user that has the <code>cluster-admin</code> role.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You posses the <code>cluster-admin</code> role if you can view Projects starting with the <strong>openshift-</strong> prefix. An existing user with the <code>cluster-admin</code> role can grant the same role to other users using the <code>oc adm policy add-cluster-role-to-user cluster-admin &lt;username&gt;</code> command.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Select the <strong>Administrator</strong> view from the top left.</p>
</li>
<li>
<p>Expand the <strong>Home</strong> pane in the sidemenu and select the <strong>Search</strong> section.</p>
</li>
<li>
<p>Choose <code>openshift-operators</code> in the <strong>Project</strong> dropdown at the top of the screen.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Use the <strong>Show default projects</strong> toggle if the <code>openshift-operators</code> Project is not listed.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Use the <strong>Resources</strong> dropdown to find the <strong>DevWorkspaceTemplate</strong> and select it.</p>
<div class="imageblock">
<div class="content">
<img src="_images/green/devworkspacetemplate-listing.png" alt="DevWorkspaceTemplate listing in the OpenShift Web Console">
</div>
</div>
</li>
<li>
<p>Select the <strong>web-terminal-tooling</strong> item in the resulting list, and navigate to the <strong>YAML</strong> tab on the subsequent screen.</p>
</li>
<li>
<p>Add the line <code>web-terminal.redhat.com/unmanaged-state: 'true'</code> to the <strong>annotations</strong> in the YAML.</p>
</li>
<li>
<p>Change the <strong>image</strong> property in the listed <strong>container</strong> to use the <code>quay.io/evanshortiss/summit-connect-2022-web-terminal:latest</code> container image.</p>
<div class="imageblock">
<div class="content">
<img src="_images/green/devworkspacetemplate-yaml.png" alt="DevWorkspaceTemplate YAML in the OpenShift Web Console">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_use_the_customised_web_terminal_container_image"><a class="anchor" href="#_use_the_customised_web_terminal_container_image"></a>Use the Customised Web Terminal Container Image</h3>
<div class="paragraph">
<p>Take your customised Web Terminal for a spin:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Login to the cluster as any user available to you.</p>
</li>
<li>
<p>Click the Web Terminal icon in the toolbar at the top of the screen.</p>
</li>
<li>
<p>Follow the onscreen prompts to select an existing project or create a new project that will be used to deploy the Web Terminal <a href="https://kubernetes.io/docs/concepts/workloads/pods/" target="_blank" rel="noopener">Pod</a>.</p>
</li>
<li>
<p>Verify that the terminal has started and you see a unqiue <a href="https://en.wikipedia.org/wiki/ASCII_art" target="_blank" rel="noopener">ASCII art</a> welcome message.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You might not see the ASCII art if you used a Project that had an existing terminal session.</p>
</div>
<div class="paragraph">
<p>Force the new container image to be used by deleting the existing Pod(s) using the following command in your Web Terminal session:</p>
</div>
<div class="paragraph">
<p><code>oc delete pod -l 'controller.devfile.io/devworkspace_id'</code></p>
</div>
<div class="paragraph">
<p>The Web Terminal will freeze for a moment while a new Pod is created. The new Pod will use the new customised container image and print the ASCII art. If a <strong>Try again</strong> error message is displayed, click the link and reopen the Web Terminal.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The ASCII art displayed by the customised Web Terminal is shown in the image below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/green/custom-web-terminal.png" alt="A customised Web Terminal showing ASCII Art">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_customising_the_openshift_web_console"><a class="anchor" href="#_customising_the_openshift_web_console"></a>Customising the OpenShift Web Console</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The OpenShift Web Console provides extensive customistion options. These are documented in the <a href="https://docs.openshift.com/container-platform/4.10/web_console/customizing-the-web-console.html" target="_blank" rel="noopener">Customizing the Web Console</a> section of the OpenShift documentation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Customising the Web Console requires use of a user account with <code>cluster-admin</code> permission.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_console_notification_banners"><a class="anchor" href="#_console_notification_banners"></a>Console Notification Banners</h3>
<div class="paragraph">
<p>A notification banner can be added to the OpenShift Console using a <a href="https://docs.openshift.com/container-platform/4.10/web_console/customizing-the-web-console.html#creating-custom-notification-banners_customizing-web-console" target="_blank" rel="noopener">ConsoleNotification CRD</a>. An example is shown in the following screenshot.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/green/custom-notification-banner.png" alt="A custom banner at the top of the OpenShift Web Console">
</div>
</div>
<div class="paragraph">
<p>Add this banner to your cluster:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select the <strong>Developer Perspective</strong> from the side-menu on OpenShift.</p>
</li>
<li>
<p>Click the <strong>Search</strong> link in the side-menu of the Developer Perspective.</p>
</li>
<li>
<p>Search for the <strong>ConsoleNotification</strong> using the <strong>Resources</strong> dropdown. Check the box beside it when listed.</p>
<div class="imageblock">
<div class="content">
<img src="_images/green/search-consolenotification.png" alt="Search feature in the OpenShift Web Console showing the ConsoleNotification listing">
</div>
</div>
</li>
<li>
<p>Click the <strong>Create ConsoleNotification</strong> button.</p>
</li>
<li>
<p>Replace the YAML sample with the following content:</p>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: console.openshift.io/v1
kind: ConsoleNotification
metadata:
  name: hackathon-banner
spec:
  text: Welcome to the Green Team OpenShift cluster for the Summit Connect Hackathon!
  location: BannerTop
  link:
    href: 'https://github.com/redhat-scholars/quickstart-workshop/tree/master/apps/green'
    text: (View Code for the Green Team Cluster)
  color: '#fafafa'
  backgroundColor: '#65a30d'</code></pre>
</div>
</div>
</li>
<li>
<p>Click the <strong>Create</strong> button.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are unable to create the ConsoleNotification, make sure to log in as a user with <strong>cluster-admin</strong> permissions and try again.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Take note of the link to a GitHub repository in the ConsoleNotification. You&#8217;ll be using that code shortly!</p>
</div>
</div>
<div class="sect2">
<h3 id="_customise_the_cluster_branding"><a class="anchor" href="#_customise_the_cluster_branding"></a>Customise the Cluster Branding</h3>
<div class="paragraph">
<p>A custom logo and/or custom product name can be applied by modifying the <a href="https://docs.openshift.com/container-platform/4.10/web_console/customizing-the-web-console.html#adding-a-custom-logo_customizing-web-console" target="_blank" rel="noopener">Console CR</a>.</p>
</div>
<div class="paragraph">
<p>Follow these instructions to set a custom logo on your cluster:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Login to your OpenShift Web Console as a user with <code>cluster-admin</code> permissions.</p>
</li>
<li>
<p>Open the Web Terminal.</p>
</li>
<li>
<p>Download a logo file using cURL inside the Web Terminal:</p>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl <a href="https://raw.githubusercontent.com/redhat-scholars/quickstart-workshop/master/apps/green/green-team.png" class="bare">https://raw.githubusercontent.com/redhat-scholars/quickstart-workshop/master/apps/green/green-team.png</a> -o /tmp/green-team.png</code></pre>
</div>
</div>
</li>
<li>
<p>Use the Web Terminal to create a ConfigMap in the <strong>openshift-config</strong> namespace on your OpenShift cluster to store the logo binary data:</p>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc create configmap console-custom-logo \
--from-file /tmp/green-team.png -n openshift-config</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The last step in this process is to instruct the OpenShift Web Console to display your logo instead of the default logo. This requires modifying the existing Console CR. This can be accomplished using the either the <code>oc edit</code> or <code>oc patch</code> commands. Use the <code>oc patch</code> command to apply the Console configuration change:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the patch YAML by running the following command in the Web Terminal:</p>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cat &lt;&lt;EOF &gt; /tmp/patch.yaml
spec:
  customization:
    customLogoFile:
      key: green-team.png
      name: console-custom-logo
EOF</code></pre>
</div>
</div>
</li>
<li>
<p>Run the patch command, applying the change to the <strong>Console</strong> item named <strong>cluster</strong>:</p>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc patch consoles.operator.openshift.io cluster \
--type merge --patch-file /tmp/patch.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Wait a minute, and refresh your web browser. The custom logo should be displayed in the top-left of the OpenShift Web Console.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/green/custom-logo.png" alt="A custom logo at the top of the OpenShift Web Console">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_gitops_to_manage_cluster_resources"><a class="anchor" href="#_using_gitops_to_manage_cluster_resources"></a>Using GitOps to Manage Cluster Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section you’ll add further customisations known as QuickStarts to the OpenShift cluster, but there&#8217;s a twist! You&#8217;ll be using link: <a href="https://docs.openshift.com/container-platform/4.10/cicd/gitops/understanding-openshift-gitops.html" target="_blank" rel="noopener">OpenShift GitOps</a> to synchronise the QuickStart YAML definitions from a Git repository to the OpenShift cluster. The QuickStarts will guide users through the steps required to manage a resource using OpenShift GitOps.</p>
</div>
<div class="paragraph">
<p>If you’re not familiar with it, GitOps is a set of practices to manage infrastructure and application configurations using Git repositories as a single source of truth for declarative infrastructure. Red Hat OpenShift GitOps uses <a href="https://argo-cd.readthedocs.io/en/stable/" target="_blank" rel="noopener">Argo CD</a> to maintain cluster resources. Argo CD is an open-source declarative tool for the continuous integration and continuous deployment (CI/CD) of applications.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/green/gitops-argo-sync.png" alt="Simplified Argo CD Flow Diagram">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It&#8217;s possible to run OpenShift GitOps on the same cluster that you want to sync resources to, or on a separate cluster and sync resources to one or more distinct clusters. In this workshop we&#8217;re running everything on a single cluster to remove the need for managing multiple clusters.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_access_the_cluster_argo_cd_instance"><a class="anchor" href="#_access_the_cluster_argo_cd_instance"></a>Access the Cluster Argo CD Instance</h3>
<div class="paragraph">
<p>To get started, you’ll need to access the Argo CD UI:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Login to your OpenShift cluster as a “cluster-admin” user.</p>
</li>
<li>
<p>Expand the <strong>Application Launcher</strong> menu (the 3x3 sqaure icon) in the top-right of the OpenShift console.</p>
<div class="imageblock">
<div class="content">
<img src="_images/green/gitops-url.png" alt="Expanded Application Launcher in the OpenShift Web Console showing an Argo CD Link">
</div>
</div>
</li>
<li>
<p>Click the <strong>Cluster Argo CD</strong> link to load the Argo CD UI.</p>
</li>
<li>
<p>Use the <strong>Log in via OpenShift</strong> button to initiate an OpenShift SSO login flow. Enter your password and accept the permissions request when prompted.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This Argo CD instance has been pre-configured to support integration with OpenShift SSO. All users on the cluster can login, but only users in <code>cluster-admins</code> group have write access.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>You will be redirected to the Argo CD applications dashboard upon successful login.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/green/gitops-dashboard.png" alt="The Argo CD Dashboard">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_applications_and_argo_cd"><a class="anchor" href="#_applications_and_argo_cd"></a>Applications and Argo CD</h3>
<div class="paragraph">
<p>Argo CD uses an <a href="https://argo-cd.readthedocs.io/en/stable/operator-manual/declarative-setup/#applications" target="_blank" rel="noopener">Application CRD</a> to represent deployed application resources. The Application definition specifies the <code>source</code> state, represented using YAML files in a Git repository, and a <code>destination</code> cluster and namespace in which to deploy the resources.</p>
</div>
<div class="paragraph">
<p>An example Application CR is shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: guestbook
  namespace: guestbook
spec:
  project: default
  source:
    repoURL: <a href="https://github.com/argoproj/argo" class="bare">https://github.com/argoproj/argo</a> cd-example-apps.git
    targetRevision: HEAD
    path: guestbook
  destination:
    server: <a href="https://kubernetes.default.svc" class="bare">https://kubernetes.default.svc</a>
    namespace: guestbook</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will create an Argo CD Application that uses source files defined in the <a href="https://github.com/redhat-scholars/quickstart-workshop/tree/master/apps/green/console-customisations" target="_blank" rel="noopener">redhat-scholars/quickstart-workshop repository</a>. Take a look at these files and you might notice that some, such as the <em>consolenotifiction.hackathon-banner.yaml</em> look familiar.</p>
</div>
</div>
<div class="sect2">
<h3 id="_create_an_application_in_argo_cd"><a class="anchor" href="#_create_an_application_in_argo_cd"></a>Create an Application in Argo CD</h3>
<div class="paragraph">
<p>Applications can be created using the Argo CD UI, or by directly by applying Application CRs to your OpenShift cluster using the OpenShift CLI or the OpenShift Web Console.</p>
</div>
<div class="paragraph">
<p>Create an Application using the Argo CD UI:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Login to the Argo CD applications dashboard.</p>
</li>
<li>
<p>Click the <strong>Create Application</strong> button on the Argo CD applications dashboard. An overlay will appear.</p>
<div class="imageblock">
<div class="content">
<img src="_images/green/gitops-dashboard-new-app.png" alt="New Application Button in Argo CD">
</div>
</div>
</li>
<li>
<p>Set the following paramaters in <strong>General</strong> section of the overlay:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Application Name:</strong> <code>console-customisations</code></p>
</li>
<li>
<p><strong>Project:</strong> <code>default</code></p>
</li>
<li>
<p><strong>Sync Policy:</strong> <code>automatic</code></p>
</li>
<li>
<p><strong>Self Heal:</strong> <code>Enabled</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Set the following paramaters in <strong>Source</strong> section of the overlay:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Repository URL:</strong> <code><a href="https://github.com/redhat-scholars/quickstart-workshop/" class="bare">https://github.com/redhat-scholars/quickstart-workshop/</a></code></p>
</li>
<li>
<p><strong>Revision:</strong> <code>HEAD</code></p>
</li>
<li>
<p><strong>Path:</strong> <code>apps/green/console-customisations</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Set the following paramaters in <strong>Destination</strong> section of the overlay:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Cluster URL:</strong> <code><a href="https://kubernetes.default.svc" class="bare">https://kubernetes.default.svc</a></code></p>
</li>
<li>
<p><strong>Namespace:</strong> <code>default</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Set the following paramaters in <strong>Directory</strong> section of the overlay:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Directory Recurse:</strong> <code>Enabled</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Click the <strong>Create</strong> button at the top of the overlay.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The <strong>console-customisations</strong> Application will be created, and the status of the Application will be shown in the Argo CD UI.</p>
</div>
<div class="paragraph">
<p>All of the listed resources will be synced to the OpenShift cluster. Changes made in to resources in the Git repository will automatically be detected and synchronised to the OpenShift cluster by Argo CD.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/green/gitops-application.png" alt="An application being rendered in the Argo CD UI">
</div>
</div>
<div class="paragraph">
<p>Return to the OpenShift Console, refresh the page, and verify that:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The previously added <strong>ConsoleNotification</strong> banner message has been modified.</p>
</li>
<li>
<p>The <strong>Application Launcher</strong> menu (the 3x3 sqaure icon) contains a <strong>Hackathon Resources</strong> section.</p>
</li>
<li>
<p>Selecting <strong>Quick Starts</strong> from the <strong>Help Menu</strong> (question mark icon) in the top-right of the OpenShift Web Console lists new Quick Starts named <em>Customise</em>, <em>Deploy</em> and <em>Observe</em>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/green/gitops-managed-ui.png" alt="Custom Quick Starts displayed in the OpenShift Web Console">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_follow_the_quick_starts"><a class="anchor" href="#_follow_the_quick_starts"></a>Follow the Quick Starts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Congratulations on making it this far! You&#8217;re now ready to start your own cluster customisation journey.</p>
</div>
<div class="paragraph">
<p>To get started visit the Quick Starts, and complete the Quick Start named <strong>Summit Connect Hackathon (Customise)</strong>. Remember, you can find the Quick Starts by selecting <strong>Quick Starts</strong> from the <strong>Help Menu</strong> (question mark icon) in the top-right of the OpenShift Web Console.</p>
</div>
<div class="paragraph">
<p>After completing this Quick Start you&#8217;ll have a Git repository that contains your unique customisations, and you can synchronise them with your cluster using Argo CD.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="03-menu.html">3. Customization Menu</a></span>
  <span class="next"><a href="03-red.html">3. Red Customizations</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
